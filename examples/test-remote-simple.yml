# Test Remote Includes - Simple
version: 1.0

# Test with local includes first, then show remote syntax
include:
  - "shared/docker-common.yml"

recipes:
  test-remote-parsing:
    help: "Test remote include URL parsing"
    run: |
      {{ step "Testing remote include parsing" }}
      
      echo "🔍 Remote URL Patterns Supported:"
      echo ""
      echo "HTTP/HTTPS:"
      echo "  https://raw.githubusercontent.com/org/repo/main/drun.yml"
      echo ""
      echo "Git with branch:"
      echo "  git+https://github.com/org/repo.git@main:path/to/file.yml"
      echo ""
      echo "Git with tag:"
      echo "  git+https://github.com/org/repo.git@v1.0.0:drun.yml"
      echo ""
      echo "Git default (uses main branch and drun.yml):"
      echo "  git+https://github.com/org/repo.git"
      echo ""
      
      {{ info "Remote includes are now implemented!" }}
      {{ success "URL parsing ready for testing" }}

  show-cache-location:
    help: "Show where remote includes would be cached"
    run: |
      {{ step "Remote Include Cache Information" }}
      
      CACHE_DIR="$HOME/.drun/cache/includes"
      echo "Cache Directory: $CACHE_DIR"
      
      if [ -d "$CACHE_DIR" ]; then
        echo "Cache directory exists"
        echo "Contents:"
        ls -la "$CACHE_DIR" 2>/dev/null || echo "  (empty)"
      else
        echo "Cache directory will be created on first remote include"
      fi
      
      {{ success "Cache information displayed" }}

  test-local-includes:
    help: "Test that local includes still work"
    deps: [docker-info]  # From shared/docker-common.yml
    run: |
      {{ step "Testing local includes" }}
      
      {{ info "Local includes are working!" }}
      {{ info "The docker-info dependency was loaded from shared/docker-common.yml" }}
      
      {{ success "Local includes test passed" }}
