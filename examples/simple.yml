# Simple/Minimal Example
# Perfect for getting started with drun
# Usage: drun -f examples/simple.yml <recipe>

version: 1.0

recipes:
  # Basic hello world
  hello:
    help: "Say hello"
    run: |
      echo "Hello from drun! üëã"

  # Recipe with positional argument
  greet:
    help: "Greet someone by name"
    positionals:
      - name: name
        required: true
    run: |
      echo "Hello, {{ .name }}! Nice to meet you. üòä"

  # Recipe with optional argument and default
  greet-polite:
    help: "Polite greeting with optional title"
    positionals:
      - name: name
        required: true
      - name: title
        default: "friend"
    run: |
      echo "Good day, {{ .title }} {{ .name }}! üé©"

  # Recipe with dependencies
  prepare:
    help: "Prepare the workspace"
    run: |
      echo "üìÅ Creating workspace..."
      mkdir -p workspace
      echo "‚úÖ Workspace ready!"

  work:
    help: "Do some work (requires preparation)"
    deps: [prepare]
    run: |
      echo "üíº Working in the prepared workspace..."
      echo 'Current time: {{ now "15:04:05" }}' > workspace/work.txt
      echo "‚úÖ Work completed!"

  # Recipe with environment variables
  show-env:
    help: "Show environment information"
    env:
      GREETING: "Hello from {{ os }} on {{ arch }}"
      TIMESTAMP: '{{ now "2006-01-02 15:04:05" }}'
    run: |
      echo "Environment Info:"
      echo "=================="
      echo "Greeting: $GREETING"
      echo "Timestamp: $TIMESTAMP"
      echo 'User: {{ env "USER" }}'
      echo 'Home: {{ env "HOME" }}'

  # Recipe with conditional logic
  check-os:
    help: "Check operating system and show appropriate message"
    run: |
      {{ if eq os "darwin" }}
      echo "üçé You're running on macOS!"
      echo "Homebrew is probably your friend."
      {{ else if eq os "linux" }}
      echo "üêß You're running on Linux!"
      echo "The power of open source is with you."
      {{ else if eq os "windows" }}
      echo "ü™ü You're running on Windows!"
      echo "PowerShell is your shell of choice."
      {{ else }}
      echo "ü§î Unknown operating system: {{ os }}"
      {{ end }}

  # Recipe that demonstrates file operations
  backup:
    help: "Create a simple backup"
    positionals:
      - name: source
        required: true
      - name: destination
        default: 'backup_{{ now "2006-01-02_15-04-05" }}'
    run: |
      echo "üì¶ Creating backup of {{ .source }}..."
      if [ -e "{{ .source }}" ]; then
        cp -r "{{ .source }}" "{{ .destination }}"
        echo "‚úÖ Backup created: {{ .destination }}"
      else
        echo "‚ùå Source not found: {{ .source }}"
        exit 1
      fi

  # Recipe with cleanup
  cleanup:
    help: "Clean up workspace and temporary files"
    run: |
      echo "üßπ Cleaning up..."
      rm -rf workspace
      rm -f backup_*
      echo "‚úÖ Cleanup completed!"

  # Show all available recipes (custom help)
  help:
    help: "Show detailed help for all recipes"
    run: |
      echo "üöÄ Simple drun Example"
      echo "======================"
      echo ""
      echo "Available recipes:"
      echo "  hello         - Basic greeting"
      echo "  greet <name>  - Personal greeting"
      echo "  greet-polite <name> [title] - Polite greeting"
      echo "  prepare       - Set up workspace"
      echo "  work          - Do work (needs prepare)"
      echo "  show-env      - Display environment info"
      echo "  check-os      - Check your operating system"
      echo "  backup <src> [dest] - Create backup"
      echo "  cleanup       - Clean up files"
      echo ""
      echo "Examples:"
      echo "  drun greet Alice"
      echo "  drun greet-polite Bob Mr."
      echo "  drun backup myfile.txt"
      echo "  drun work"
